
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://dram1964.github.com/cloudarchitect/python/pandas/pandas/">
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>Notes on Pandas - Cloud Architecture notes</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.7e37652d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#notes-on-pandas" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Cloud Architecture notes" class="md-header__button md-logo" aria-label="Cloud Architecture notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Cloud Architecture notes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Notes on Pandas
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Cloud Architecture notes" class="md-nav__button md-logo" aria-label="Cloud Architecture notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Cloud Architecture notes
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    IT Operations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            IT Operations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../operations/soar/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SOAR
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Azure
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Azure
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../azure/az104/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AZ104 Reference
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../azure/cli_commands/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CLI Commands
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../azure/aad/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure AD
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../azure/compute/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure Compute
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../azure/keyvault/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure Key Vault
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Azure Fundamentals
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            Azure Fundamentals
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../azure/afc/core_concepts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Core Concepts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../azure/afc/core_services/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Core Services
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../azure/afc/core_management_tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Core Management Tools
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../azure/afc/security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Security
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../azure/afc/governance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Governance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../azure/afc/costs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Costs
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" >
        
          
          <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    App Service
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            App Service
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../azure/app_service/app_service/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    App Service Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../azure/app_service/flask_app_service_part_one/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    App Service Deplyment: Part 1
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../azure/kusto/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    KQL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../azure/monitor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure Monitor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../azure/networking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure Networking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../azure/storage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure Storage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_12" >
        
          
          <label class="md-nav__link" for="__nav_3_12" id="__nav_3_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Databases
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_12">
            <span class="md-nav__icon md-icon"></span>
            Databases
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../azure/db/postgresql/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PostgreSQL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../azure/db/cosmosdb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CosmosDB
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../azure/aml/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Machine Learning
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Devops
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Devops
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../devops/devops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../devops/git_commands/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Git Client
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../devops/github_actions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Github Actions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../devops/porter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Porter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../devops/cloudinit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cloud Init
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6" >
        
          
          <label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Terraform
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_6">
            <span class="md-nav__icon md-icon"></span>
            Terraform
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../devops/terraform/intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Intro
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../devops/terraform/blocks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Blocks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../devops/terraform/variables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Variables
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../devops/terraform/meta/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Meta-Arguments
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../devops/terraform/functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../devops/terraform/provisioner/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Provisioners
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../devops/terraform/modules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Modules
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../devops/terraform/state/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Remote State
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Linux
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Linux
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../linux/commands/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Commands
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../linux/bash_scripting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bash Scripting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../linux/awk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Awk
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../linux/performance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Performance
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Databricks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Databricks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../databricks/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../databricks/fundamentals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Databbricks Lakehouse Fundamentals
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Python
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../venv/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    venv
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Pandas
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            Pandas
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_frame_basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DataFrame Basics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_wrangling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Wrangling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_aggregation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Aggregation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_visualisation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Visualisation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../statistics_101/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Statistics 101
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../jupyter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Jupyter
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#series" class="md-nav__link">
    <span class="md-ellipsis">
      Series
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dataframes" class="md-nav__link">
    <span class="md-ellipsis">
      DataFrames
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#external-data" class="md-nav__link">
    <span class="md-ellipsis">
      External Data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examining-data" class="md-nav__link">
    <span class="md-ellipsis">
      Examining Data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#selecting-data" class="md-nav__link">
    <span class="md-ellipsis">
      Selecting Data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filtering-data" class="md-nav__link">
    <span class="md-ellipsis">
      Filtering Data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#derived-data" class="md-nav__link">
    <span class="md-ellipsis">
      Derived Data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-joins" class="md-nav__link">
    <span class="md-ellipsis">
      Data Joins
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-cleansing" class="md-nav__link">
    <span class="md-ellipsis">
      Data Cleansing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aggregate-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Aggregate Functions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#working-with-datetime-values" class="md-nav__link">
    <span class="md-ellipsis">
      Working with Datetime Values
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#working-with-string-values" class="md-nav__link">
    <span class="md-ellipsis">
      Working with String Values
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matplotlib" class="md-nav__link">
    <span class="md-ellipsis">
      Matplotlib
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plotly" class="md-nav__link">
    <span class="md-ellipsis">
      Plotly
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#row-comprehensions" class="md-nav__link">
    <span class="md-ellipsis">
      Row Comprehensions
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="notes-on-pandas">Notes on Pandas</h1>
<p>Notes from the Pandas 
<a href="https://pandas.pydata.org/docs/getting_started/index.html">Getting Started</a> 
guide</p>
<h2 id="series">Series</h2>
<p>A <code>pandas.Series</code> object is a data structure for an array of data of a single
type, and can be thought of as a column in a table. Create a Series by 
providing an array of values: </p>
<pre><code class="language-python">import numpy as np
import pandas as pd

np.random.seed(0) # set a seed so that the random numbers are always the same
pd.Series(np.random.rand(5), name='random')
</code></pre>
<p>In addition to the data we provide the Series object, pandas adds in Index
object representing the row numbers. The Index object can be used to perform 
element-wise operations on Series objects. For example, addition using two
Series objects, will add the values for the elements with matching index
values. Where the indexes do not match, the result will return a null value 
(<code>NaN</code> or <code>None</code>) for those index values. </p>
<h2 id="dataframes">DataFrames</h2>
<p>A DataFrame is a 2-dimensional data structure used to store data in columns. </p>
<p>To create a DataFrame manually, use a dictionary of lists:</p>
<pre><code class="language-python">df = pd.DataFrame(
  {
    'Forename': ['Jeff', 'James', 'Eric', 'Clark'],
    'Surname': ['Jefferson', 'Jameson', 'Ericsson', 'Clarkson'],
    'Date of Death': ['15/12/2021', '12/05/2002', '25/10/2023', '28/07/2012'],
    'Place of Death': [np.random.choice(['Norfolk', 'Shropshire', 'Devon', 'Bedfordshire']) for _ in range(4)] ,
    'Deceased': [np.random.choice(['Yes', 'No']) for _ in range(4) ],
    'Age' : np.random.rand(4) * 100
  }
)
</code></pre>
<p>Or a list of dictionaries: </p>
<pre><code class="language-python">df2 = pd.DataFrame([
    {'forename': 'Jeff', 'surname': 'Jefferson', 'date of death': '15/12/2021'},
    {'forename': 'James', 'surname': 'Jameson', 'date of death': '01/10/2021'},
    {'forename': 'Eric', 'surname': 'Ericsson', 'date of death': '11/05/2021'},
    {'forename': 'Clark', 'surname': 'Clarkson', 'date of death': '25/02/2021'},
])
</code></pre>
<p>Or a list of tuples:</p>
<pre><code class="language-python">df3 = pd.DataFrame([
    ('Jeff', 'Jefferson', '15/12/2021'),
    ('James', 'Jameson', '01/10/2021'),
    ('Eric', 'Ericsson', '11/05/2021'),
    ('Clark', 'Clarkson', '25/02/2021')],
    columns=['forename', 'surname', 'date of death']
)
</code></pre>
<p>Or a list of lists:</p>
<pre><code class="language-python">df5 = pd.DataFrame([
        ['Jeff', 'Jefferson', '15/12/2021'],
        ['James', 'Jameson', '01/10/2021'],
        ['Eric', 'Ericsson', '11/05/2021'],
        ['Clark', 'Clarkson', '25/02/2021']
    ],
    columns=['forename', 'surname', 'date of death']
)
</code></pre>
<p>Or a <code>numpy</code> array:</p>
<pre><code class="language-python">df4 = pd.DataFrame(
    np.array([
        ['Jeff', 'Jefferson', '15/12/2021'],
        ['James', 'Jameson', '01/10/2021'],
        ['Eric', 'Ericsson', '11/05/2021'],
        ['Clark', 'Clarkson', '25/02/2021']
    ]),
    columns=['forename', 'surname', 'date of death']
)
</code></pre>
<h2 id="external-data">External Data</h2>
<p>DataFrames can be created from CSV files using the pandas <code>read_csv</code> function:</p>
<pre><code class="language-python">df = pd.read_csv(&quot;data/unclaimedestates.csv&quot;, parse_dates=True)
</code></pre>
<p>The <code>read_csv</code> function provides additional arguments to allow you to 
specifiy seperators, delimiters, etc. Use <code>help(pd.read_csv)</code> or 
<code>pd.read_csv?</code> for the full function definition. </p>
<p>There are functions for reading data in various formats, all beginning with
a <code>read_</code> prefix: e.g. <code>read_json</code>, <code>read_excel</code>, <code>read_sql</code>. Try: </p>
<pre><code class="language-python">functions = [function for function in dir(pd) if function.startswith('read_')]
</code></pre>
<p>To read data from a database, you need to provide a both a query or table name
and a connection object: </p>
<pre><code class="language-python">import pandas as pd
from sqlalchemy import URL, create_engine
import psycopg2

psql_connection_string = URL.create(
    'postgresql',
    username='user_name',
    password='passwd',
    host='server_name,
    port=5432,
    database='database_name'
)
conn = create_engine(psql_connection_string)

query = '''
SELECT * FROM
&quot;schema_name&quot;.&quot;table_name&quot;
WHERE collected_date &gt; CURRENT_DATE - INTERVAL '60 days'
ORDER BY collected_date desc
'''

df = pd.read_sql_query(query,con=conn)
</code></pre>
<p>DataFrames can also be written to external files 
using the corresponding <code>to_</code> methods: e.g.
<code>to_json</code>, <code>to_excel</code>, <code>to_sql</code>. With the <code>to_sql</code> function you can provide
the table name, connection and what action to take if the table already 
exists: </p>
<pre><code class="language-python">df.to_sql(name='users', con=connection, if_exists='replace')
</code></pre>
<p>Pandas <code>to_</code> functions will also allow to you include or exclude
the DataFrame index in the output: </p>
<pre><code class="language-python">df.to_excel(&quot;recipes.xlsx&quot;, sheet_name=&quot;flapjack&quot;, index=False)
</code></pre>
<h2 id="examining-data">Examining Data</h2>
<p>DataFrame objects provide a number of attributes and functions that 
you can use to examine the data frame. </p>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>shape</td>
<td>number of rows and columns</td>
</tr>
<tr>
<td>columns</td>
<td>names of the columns</td>
</tr>
<tr>
<td>dtypes</td>
<td>data type for each column</td>
</tr>
</tbody>
</table>
<p>All the output from the <code>shape</code>, <code>columns</code>, and <code>dtypes</code> attributes is 
also provided through the <code>info</code> function, along with details on the index
and memory usage: </p>
<pre><code class="language-python">df.info()
</code></pre>
<p>The <code>describe</code> method provides summary data (min, max, mean, count and percentiles) 
for the numeric columns, but can also be used to get some summary data 
(count, unique values, mode, frequency of mode) for non-numeric data:</p>
<pre><code class="language-python">df.describe(include=np.object)
# or
df.describe(include='all')
</code></pre>
<p>By default <code>describe</code> provides the 0.25, 0.5, 0.75 percentiles but you can select 
these with the <code>percentiles</code> parameter:</p>
<pre><code class="language-python">df.describe(percentiles=[0.05, 0.50, 0.95])
</code></pre>
<p><code>describe</code> only provides summary statistics for non-null values.</p>
<p>Each summary statistic is also available via separate summary methods that
can be applied to either the DataFrame or Series objects, e.g <code>min</code>, <code>max</code>, 
<code>idxmin</code>, <code>idxmax</code>, <code>sum</code>, <code>mean</code>, <code>median</code>. For Series objects additional 
summary methods exist: <code>unique</code>, <code>value_counts</code> and <code>mode</code>. </p>
<h2 id="selecting-data">Selecting Data</h2>
<p>Display the dataframe by calling its name. This will display the first 5 rows 
and the last 5 rows. To show the first <em>n</em> rows, use the <code>head</code> method, or
<code>tail</code> for the last <em>n</em> rows, or <code>sample</code> for <em>n</em> random values:</p>
<pre><code class="language-python">df.sample(10)
</code></pre>
<p>Each column in a DataFrame is a Series. To select a column from a DataFrame, 
use the column label between square brackets. For multiple columns supply a 
list:</p>
<pre><code class="language-python">df[[&quot;Place of Death&quot;, &quot;Date of Birth&quot;]
</code></pre>
<p>DataFrames support <code>slicing</code> operations, which can be combined with column
selection: </p>
<pre><code class="language-python">df[[&quot;Place of Death&quot;, &quot;Date of Birth&quot;]][5:15]
# Order doesn't matter
df[5:15][[&quot;Place of Death&quot;, &quot;Date of Birth&quot;]]
</code></pre>
<p>For date indexes, slicing can also be done using dateparts or ranges: </p>
<pre><code class="language-python">df[2024]
df[2024-05]
df[2024-01:2024-04]
</code></pre>
<p>However, using slicing and selection to assign values to a DataFrame
is not the recommended approach: instead you should use the <code>loc</code> or 
<code>iloc</code> methods. <code>loc</code> and <code>iloc</code> accept two <code>labels</code>: 
a row selector and a column selector. Either selector can be 
expressed as a single value, a list or a slice. :</p>
<pre><code class="language-python">df.loc[2, 'Surname']
df.loc[[2,3], 'Surname']
df.loc[2:3, 'Surname']

df.loc[df.Surname == 'Johnson', ['Forename','Surname']]
df.loc[df.Surname == 'Johnson', 'Forename':'Surname']

df.loc[[df.Age.idxmin(), df.Age.idxmax()], :]
</code></pre>
<p>With <code>loc</code>, slicing operations are inclusive of the end index if provided. <code>iloc</code> 
instead follows the standard python-slicing approach, and excludes the end value
of a slice if provided. <code>iloc</code> expects integer values for both row selectors and 
column selectors:</p>
<pre><code class="language-python"># returns only the value at row 2, column 1 and 2
df.iloc[2:3, 1:3]

# returns values at rows 2 and 3, column 1, 2 and 3
df.iloc[[2,3],[1,2,3]]
</code></pre>
<p><code>iloc</code> allows slicing for both row and column selectors. </p>
<p>For selecting a single value from a DataFrame, the <code>at</code> and <code>iat</code> methods
provide better performance: </p>
<pre><code class="language-python">wanted = df.at[2,'Surname']
wanted = df.iat[2,1]
</code></pre>
<h2 id="filtering-data">Filtering Data</h2>
<p>You can filter the output using a condition inside the selection brackets:</p>
<pre><code class="language-python">df[df[&quot;Date of Birth&quot;] &lt; '01/01/1970']
</code></pre>
<p>The <code>isin()</code> method can be used to check for multiple conditions on 
a column:</p>
<pre><code class="language-python">df[df[&quot;Surname&quot;].isin([&quot;Smith&quot;, &quot;Jones&quot;])]
</code></pre>
<p>You can also use the 'or' operator to acheve the same result: </p>
<pre><code class="language-python">df[(df[&quot;Surname&quot;] == &quot;Jones&quot;) | (df[&quot;Surname&quot;] == &quot;Smith&quot;)]
</code></pre>
<p>The <strong>AND Operator</strong> <code>(&amp;)</code> can be used to specify multiple conditions
that should all return <code>True</code>. The <strong>Negation Operator</strong> <code>(~)</code> can 
be used to negate the return value of a condition: </p>
<pre><code class="language-python">df[~(df.Surname == 'Jameson')]
</code></pre>
<p>To filter out rows where a particular column has Null values, use the
<code>notna()</code> method:</p>
<pre><code>df[df[&quot;Executors&quot;].notna()]
</code></pre>
<p>We can also use strings and regular expressions: </p>
<pre><code class="language-python"># contains 'son' anywhere in the string
df[df.Surname.str.contains('son')]

## contains 'son' at the end of the string
df[df.Surname.str.contains(r'son$')]

## contains 'Jeff' or 'James' at the beginning of the string
df[df.Surname.str.contains(r'^Jeff|James')]
</code></pre>
<p>To filter numeric values with a lower and upper range use <code>between</code>:</p>
<pre><code class="language-python">df[df.Age.between(10,32, inclusive='both')]
</code></pre>
<p>These filtering techniques can also be used for row labels in both
the <code>loc</code> or <code>iloc</code> operators.</p>
<h2 id="derived-data">Derived Data</h2>
<p>To avoid altering our original data we can use <code>copy</code> to create
a new copy of the DataFrame:</p>
<pre><code class="language-python">df_clean = df.copy()
</code></pre>
<p>You can add new columns to a DataFrame using assignments:</p>
<pre><code class="language-python">df[&quot;Forename Lower Case&quot;] = df[&quot;Forename&quot;].str.lower()

df['Retired'] = df.Age &gt; 67
</code></pre>
<p>The <code>assign</code> method allows us to add multiple columns at once. However,
<code>assign</code> does not change the original DataFrame, but returns a new one. 
If you want to change the original, just assign the return value back to 
the original DataFrame: </p>
<pre><code class="language-python">df = df.assign(
    is_retired=df.Age &gt;= 67,
    is_working_age=(df.Age &gt;= 18) &amp; (df.Age &lt; 67),
    is_child=df.Age &lt; 18
)
</code></pre>
<p>The same <code>assign</code> statement can be written with <code>lambda</code> functions: </p>
<pre><code class="language-python">df = df.assign(
    is_retired=lambda x: x.Age &gt;= 67,
    is_working_age=lambda x: x.Age.between(18,67,inclusive='left'),
    is_child=lambda x: x.Age &lt; 18
)
</code></pre>
<p>The <code>rename()</code> method can be used to rename columns:</p>
<pre><code class="language-python">df_renamed = df.rename(
    columns={
        &quot;Date of Publication&quot;: &quot;publication_date&quot;,
        &quot;Date of Death&quot;: &quot;death_date&quot;,
        &quot;Date of Birth&quot;: &quot;birth_date&quot;,
    }
)
</code></pre>
<h2 id="data-joins">Data Joins</h2>
<p>The <code>concat()</code> method can be used to combine two tables with a similar structure.
You can specify an axis of '0' to add the second DataFrame as new rows, or an 
axis of '1' to add the DataFrame as new columns. </p>
<p>To join the rows of two tables use:</p>
<pre><code class="language-python">disk_data = pd.concat([disk_data_server_1, disk_data_server_2], axis=0)
</code></pre>
<p>If either DataFrame contains columns not found in the other, these will be
added as new columns in the new DataFrame, and the rows where these columns
did not exist, will be filled with <code>NaN</code>. This behaviour can be change by
specifying the join type as 'inner': which only keeps columns that are common
to the input DataFrames. </p>
<p>The 'ignore_index' option can be used to create a new index for the new 
DataFrame. If you wish to keep the original indices from both input DataFrames, 
you can optionally add an additional (hierarchical) row index to identify which 
row came from which input DataFrame:</p>
<pre><code class="language-python">disk_data = pd.concat([disk_data_server_1, disk_data_server_2], axis=0, keys=[&quot;srv1&quot;, &quot;srv2&quot;])
</code></pre>
<p>This produces a DataFrame with a <em>multi-index</em>. To access entries by index value, 
supply a tuple or list of tuples: </p>
<pre><code class="language-python">disk_data.loc[[('srv2',0),('srv2',1)],:]
</code></pre>
<p>When using <code>concat</code> in a columnwise join (<code>axis=1</code>), Pandas uses the row indexes 
to make the joins. For rows that don't share a common index, values are filled
with <code>NaN</code>. </p>
<h2 id="data-cleansing">Data Cleansing</h2>
<p>Use the <code>drop()</code> method to remove unwanted rows or columns. Set <code>inplace=True</code>
to alter the current DataFrame or use assignment to capture the resulting 
DataFrame. </p>
<p><code>drop</code> defaults to removing rows (<code>axis=0</code>), but we can also drop columns either
by specifying <code>axis=1</code> or by providing a list to the <code>columns</code> parameter: </p>
<pre><code class="language-python"># creates new dataframe and leaves the original unchanged
nameless_df = df.drop(columns=['Forename', 'Surname'])

# affects the original dataframe
df.drop(['Forename', 'Surname'], axis=1, inplace=True)
</code></pre>
<p>We can also use <code>del df['column_name']</code> to remove a specific column from 
a DataFrame. <code>pop</code> can also be used to remove a column and save this to 
a Series. If the column contains Boolean values, then this can later be
used to filter the DataFrame, even though the column no longer exists in 
the DataFrame. This works because the Series has the same index as the 
DataFrame:</p>
<pre><code class="language-python">is_retired = df.pop('Retired')

df['Retired'] # produces a key-error

retired_df = df[is_retired].copy()
not_retired_df = df[~is_retired].copy()
</code></pre>
<p>This can be useful to filter a DataFrame, without storing the filter column in
the DataFrame. The <code>copy</code> method is provided, to create new DataFrames that
can be worked on independantly of the original. </p>
<p>The filter Series does not have to contain Booleans, but can be used to
create a Boolean result:</p>
<pre><code class="language-python">where_died = df.pop('Place of Death')

df[where_died == 'Norfolk']
</code></pre>
<p>To drop rows we need to provide a list of indices: <code>df.drop([1,2], inplace=True)</code>.</p>
<p>Use <code>isna()</code> to find rows with 'NaN' vaules and <code>dropna()</code> to remove rows 
with 'NaN' values in the selected columns:</p>
<pre><code class="language-python">df_clean = df.dropna(subset=['Rating'])
</code></pre>
<p>Use <code>inplace=True</code> if you don't want to create a new dataframe.</p>
<p>Use <code>duplicated</code> to find duplicate rows and <code>drop_duplicates</code> to remove
the duplicated rows (keeping the first occurrence):</p>
<pre><code class="language-python">df_clean = df.drop_duplicates(subset = ['App', 'Type', 'Price'])
</code></pre>
<p>To convert strings to numeric data, you can perform string formatting
and then use the pandas <code>to_numeric</code> function: </p>
<pre><code class="language-python"># remove commas
df_clean['Installs'] = df_clean['Installs'].astype(str).str.replace(',',&quot;&quot;)
# remove currency symbol
df_clean['Installs'] = df_clean['Installs'].astype(str).str.replace('',&quot;&quot;)
# convert to numeric
df_clean['Installs'] = pd.to_numeric(df_clean['Installs'])
</code></pre>
<p>You can use filtering to drop unwanted values:</p>
<pre><code class="language-python">df_clean = df_clean[df_clean.Installs &gt; 300]
</code></pre>
<h2 id="aggregate-functions">Aggregate Functions</h2>
<p>Pandas provides access to aggregate methods that can be applied to one or more
columns:</p>
<pre><code class="language-python">print(df[[&quot;Date of Death&quot;, &quot;Date of Publication&quot;]].max())
print(df[[&quot;Date of Death&quot;, &quot;Date of Publication&quot;]].min())
</code></pre>
<p>The <code>agg()</code> method allows you to apply multiple aggregates to a DataFrame:</p>
<pre><code class="language-python">df_aggregations = df.agg(
    {
        &quot;Date of Death&quot;: [&quot;min&quot;, &quot;max&quot;, &quot;count&quot;, ],
        &quot;Date of Birth&quot;: [&quot;count&quot;],
        &quot;Date of Publication&quot;: [&quot;max&quot;]
    }
)
</code></pre>
<p>Use <code>group_by()</code> to group aggregates:</p>
<pre><code class="language-python">religions = df[[&quot;Nationality&quot;, &quot;Religion&quot;]].groupby(&quot;Religion&quot;).count()
</code></pre>
<p>Data can be sorted using the <code>sort_values()</code> or <code>sort_index()</code> methods:</p>
<pre><code class="language-python">print(df.sort_values(by=[&quot;Date of Birth&quot;, &quot;Place of Birth&quot;], ascending=True)[[&quot;Date of Birth&quot;, &quot;Place of Birth&quot;]])
</code></pre>
<p>The <code>pivot()</code> method can be used to reshape data, specifying columns and values. </p>
<pre><code class="language-python">df.pivot(index='DATE', columns='LANGUAGE', values='POSTS')
</code></pre>
<p>The <code>pivot_table()</code> method supports aggregation. The reverse of <code>pivot()</code> is <code>melt()</code>.</p>
<p>The <code>merge</code> method works similar to an SQL JOIN statement, producing a DataFrame 
that results from combining DataFrames using a common Series:</p>
<pre><code class="language-python">patient_result_data = pd.merge([&quot;patient&quot;, &quot;pathology&quot;], how=&quot;left&quot;, on=&quot;patient_id&quot;)
</code></pre>
<p>If the two tables to merge have the same data in different column names, use the 
<code>left_on</code> and <code>right_on</code> parameters:</p>
<pre><code class="language-python">patient_result_data = pd.merge([&quot;patient&quot;, &quot;pathology&quot;], 
    how=&quot;left&quot;, left_on=&quot;patient_id&quot;, right_on=&quot;hospital_number&quot;)
</code></pre>
<h2 id="working-with-datetime-values">Working with Datetime Values</h2>
<p>Use the <code>to_datetime()</code> method to work with datetime data in your columns.:
Use the <code>dayfirst</code> parameter for dates in "%d/%m/%Y" format. </p>
<pre><code>df = pd.read_csv(&quot;ukgovunclaimedestates.csv&quot;, parse_dates=True)

df[&quot;Date of Birth&quot;] = pd.to_datetime(df[&quot;Date of Birth&quot;], dayfirst=True)
df[&quot;Date of Death&quot;] = pd.to_datetime(df[&quot;Date of Death&quot;], dayfirst=True)

print(df.groupby(df[&quot;Date of Birth&quot;].dt.year)[&quot;Date of Birth&quot;].count())

df[&quot;Age&quot;] = df[&quot;Date of Death&quot;].dt.year - df[&quot;Date of Birth&quot;].dt.year
</code></pre>
<p>Converting columns to DateTime objects, provides access to utility methods
to extract 'year', 'month', 'day', 'weekday' and perform calculations via 
the <code>dt()</code> methods. If you set the index (using the <code>set_index()</code> method)
to a DateTime object, then you can use the same methods on the index. </p>
<pre><code class="language-python">df[&quot;date_of_birth&quot;] = pd.to_datetime(df[&quot;Date of Birth&quot;], dayfirst=True)
df.set_index(&quot;date_of_birth&quot;, inplace=True)

print(df.index.year)
</code></pre>
<h2 id="working-with-string-values">Working with String Values</h2>
<p>Using the <code>str()</code> accessor on text data, allows us to access various 
string methods, including <code>lower()</code>, <code>split()</code>, <code>replace()</code></p>
<p><code>split()</code> returns a number of elements from a single element: use the
the <code>get()</code> method to select which element you want:</p>
<pre><code class="language-python">df[&quot;Surname&quot;] = df[&quot;Name&quot;].str.split(&quot;, &quot;).str.get(0)
df[&quot;Forename&quot;] = df[&quot;Name&quot;].str.split(&quot;, &quot;).str.get(1)
</code></pre>
<p><code>replace</code> uses a dictionary to replace values:</p>
<pre><code class="language-python">df[&quot;Gender&quot;] = df[&quot;Sex&quot;].replace({&quot;male&quot;: &quot;m&quot;, &quot;female&quot;: &quot;f&quot;})
</code></pre>
<h2 id="matplotlib">Matplotlib</h2>
<p>To create a graph of a DataFrame use the <code>plot()</code> method. Pandas creates
a line plot by default for each of the Series in a DataFrame 
that has numeric values. All the plots created by Pandas are <code>Matplotlib</code>
objects. The <code>matplotlib.pyplot</code> library provides the <code>show()</code> method 
to display the graph: </p>
<pre><code class="language-python">import pandas as pd
import matplotlib.pyplot as plt

df = pd.read_csv(&quot;ukgovunclaimedestates.csv&quot;, parse_dates=True)

religions = df[&quot;Religion&quot;].groupby(df[&quot;Religion&quot;]).count()

religions.plot()

plt.show()
</code></pre>
<p>Use selection criteria on your DataFrame to choose which Series to plot.
In JupyterLab, you can specify the x and y axes for your plot:</p>
<pre><code class="language-python">plt.plot(df.index, df['java'])
</code></pre>
<p>You can use slicing to drop elements from the plot:</p>
<pre><code class="language-python">plt.plot(df.index[:-1], df['java'][:-1])
</code></pre>
<p>You can also plot mulitple columns on the same graph, and add some graph
formating:</p>
<pre><code class="language-python">plt.figure(figsize=(16,10))
plt.xticks(fontsize=14)
plt.yticks(fontsize=14)
plt.xlabel('Date', fontsize=14)
plt.ylabel('No of Posts', fontsize=14)
plt.ylim(0,35000)

plt.plot(df.index, df['java'])
plt.plot(df.index, df['python'])
</code></pre>
<p>To plot multiple columns use a <code>for</code> loop:</p>
<pre><code class="language-python">plt.figure(figsize=(16,10))
plt.xticks(fontsize=14)
plt.yticks(fontsize=14)
plt.xlabel('Date', fontsize=14)
plt.ylabel('No of Posts', fontsize=14)
plt.ylim(0,35000)

for column in df.columns:
    plt.plot(df.index, df[column], linewidth=3, label=df[column].name)

plt.legend(fontsize=14)
</code></pre>
<p>For time series data you can specify a rolling mean to smooth out the data:
instead of plotting the value of each data point, you can specify a window 
to calculate an average value for each data point based on the values either
side of the data point:</p>
<pre><code class="language-python">rolling_df = df.rolling(window=6).mean()
</code></pre>
<p>Plotting two columns with varying value-ranges can look untidy and make
trend-spotting difficult. Instead you can specify two different y-axes
for each plot to make comparison easier:</p>
<pre><code class="language-python">ax1 = plt.gca() # gets the current axis
ax2 = ax1.twinx() # create another axis that shares the same x-axis

ax1.plot(sets_by_year.index[:-2], sets_by_year.set_num[:-2], color='g')
ax2.plot(themes_by_year.index[:-2], themes_by_year.nr_themes[:-2], color='b')

ax1.set_xlabel('Year')
ax1.set_ylabel('Number of Sets', color='g')
ax2.set_ylabel('Number of Themes', color='b')
</code></pre>
<p>If your xticks overlap, you can specify a rotation to make them readable:</p>
<pre><code class="language-python">plt.xticks(fontsize=14, rotation=45)
</code></pre>
<p>You can also use locator functions for marking the x- and y- axes:</p>
<pre><code class="language-python">import pandas as pd
import matplotlib.pyplot as plt
import matplotlib.dates as mdates

df_unemployment = pd.read_csv('UE Benefits Search vs UE Rate 2004-19.csv')
df_unemployment['MONTH'] = pd.to_datetime(df_unemployment['MONTH'])

roll_df = df_unemployment[['UE_BENEFITS_WEB_SEARCH', 'UNRATE']].rolling(window=6).mean()
roll_df['month'] = df_unemployment['MONTH']


plt.figure(figsize=(16,10))
plt.title('Rolling Web Searches vs Unemployment Rate', fontsize=20)
plt.xticks(fontsize=14, rotation=45)
plt.yticks(fontsize=14)

ax1 = plt.gca()
ax2 = ax1.twinx()
ax1.grid(color='gray', linestyle='--')

ax1.set_ylabel('Web Searches', fontsize=16, color='indianred')
ax2.set_ylabel('Unemployment Rate', fontsize=16, color='cadetblue')

ax1.set_xlim(roll_df.month[5:].min(), roll_df.month[5:].max())

years = mdates.YearLocator()
months = mdates.MonthLocator()
years_fmt = mdates.DateFormatter('%Y')
ax1.xaxis.set_major_locator(years)
ax1.xaxis.set_major_formatter(years_fmt)
ax1.xaxis.set_minor_locator(months)

ax1.plot(roll_df.month[5:], roll_df.UE_BENEFITS_WEB_SEARCH[5:], color='indianred', linewidth=3, marker='o')
ax2.plot(roll_df.month[5:], df_unemployment.UNRATE[5:], color='cadetblue', linewidth=3)
</code></pre>
<p>Pandas provides a number of graph types including line, area, bar, pie and scatter:</p>
<ul>
<li><code>plt.plot</code> for a line chart</li>
<li><code>plt.scatter</code> for a scatter plot</li>
<li><code>plt.bar</code> for a bar chart</li>
</ul>
<h2 id="plotly">Plotly</h2>
<p>Bar charts are a good way to visualise 'categorical' data. You can use 
<code>value_counts()</code> to quickly create categorical data:</p>
<pre><code class="language-python">ratings = df.value_counts('Content_Rating')
</code></pre>
<p>Given a dataframe that contains the following data:</p>
<pre><code>Content_Rating
Everyone           6621
Teen                912
Mature 17+          357
Everyone 10+        305
Adults only 18+       3
Unrated               1
Name: count, dtype: int64
</code></pre>
<p>we can present this as a pie chart using plotly:</p>
<pre><code class="language-python">fig = px.pie(
    labels=ratings.index,
    values=ratings.values,
    names=ratings.index,
    title=&quot;Content Rating&quot;
)
fig.show()
</code></pre>
<p>We can change the location of the text on the pie chart using <code>update_traces()</code>:</p>
<pre><code class="language-python">fig = px.pie(
    labels=ratings.index,
    values=ratings.values,
    title='Content Rating',
    names=ratings.index,
)
fig.update_traces(
    textposition='outside', 
    textinfo='percent+label'
)
fig.show()
</code></pre>
<p>To format the pie chart as a 'doughnut chart' add the 'hole' parameter:</p>
<pre><code class="language-python">fig = px.pie(
    labels=ratings.index,
    values=ratings.values,
    title='Content Rating',
    names=ratings.index,
    hole=0.4
)
fig.update_traces(
    textposition='inside',
    textfont_size=15,
    textinfo='percent'
)
fig.show()
</code></pre>
<p>Which produces:<br></p>
<p><img alt="doughnut" src="../../images/doughnut.png" /></p>
<h2 id="row-comprehensions">Row Comprehensions</h2>
<p>The <code>to_dict()</code> method of a DataFrame will produce a dictionary mapping the column names to 
an array of the column values. If you want a dictionary mapping row values to other row values
you can use the <code>iterrows()</code> method. </p>
<p>The <code>iterrows()</code> method returns a list of tuples containing the index and row values for 
each row. This can be used in a comprehension to create a new dictionary:</p>
<pre><code class="language-python">df = pd.read_csv(&quot;ukgovunclaimedestates.csv&quot;, parse_dates=True)

person_dict = {row[&quot;BV Reference&quot;]:row[&quot;Surname&quot;] for (index, row) in df.iterrows()}
</code></pre>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.50899def.min.js"></script>
      
    
  </body>
</html>